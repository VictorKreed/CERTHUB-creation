(()=>{var e={};e.id=792,e.ids=[792],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},5197:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var i=r(687),a=r(3210),s=r(5762),n=r(3198),o=r(5814),l=r.n(o);function d(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)({institutionName:"",previousCertificateName:"",previousCertificateYear:"",certificateName:"",certificateId:"",uri:"",newCertificateYear:"",merkleRoot:"",recipients:"",certificateTokenUpdateQuantity:""}),[d,c]=(0,a.useState)("idle"),[u,p]=(0,a.useState)(null),[m,h]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),b=e=>{o({...r,[e.target.name]:e.target.value}),p(null)},g=()=>e?r.institutionName?r.previousCertificateName?!r.previousCertificateYear||isNaN(Number(r.previousCertificateYear))?(p("Valid previous certificate year is required"),!1):r.certificateName?r.certificateId?r.uri?!r.newCertificateYear||isNaN(Number(r.newCertificateYear))?(p("Valid new certificate year is required"),!1):r.merkleRoot&&/^0x[a-fA-F0-9]{64}$/.test(r.merkleRoot)?!(!r.certificateTokenUpdateQuantity||isNaN(Number(r.certificateTokenUpdateQuantity)))||(p("Valid certificate token quantity is required"),!1):(p("Invalid Merkle root (must be 32-byte hex string)"),!1):(p("URI is required"),!1):(p("Certificate ID is required"),!1):(p("New certificate name is required"),!1):(p("Previous certificate name is required"),!1):(p("Institution name is required"),!1):(p("Wallet not connected"),!1),N=async()=>{p(null),h(null),f(!0);let e=r.recipients.split(/[\s,]+/).map(e=>e.trim()).filter(e=>e&&s.PW(e));if(0===e.length){p("Please provide at least one valid Ethereum address."),f(!1);return}try{let t=await fetch("/api/merkle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({addresses:e,sortPairs:!0})}),i=await t.json();if(!t.ok||!i?.root)throw Error(i?.error||"Failed to generate Merkle root.");h(i.root),o({...r,merkleRoot:i.root});let a=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=`proofs-${r.certificateId||"certificate"}.json`,n.click(),URL.revokeObjectURL(s)}catch(e){p(e.message||"Failed to generate Merkle root.")}finally{f(!1)}},w=async t=>{if(t.preventDefault(),c("loading"),p(null),!g()){c("error");return}try{let t=await (0,n.C8)(),i=await t.updateCertificate(e,r.institutionName,r.previousCertificateName,r.certificateName,r.certificateId,r.uri,Number(r.previousCertificateYear),Number(r.newCertificateYear),r.merkleRoot,Number(r.certificateTokenUpdateQuantity));await i.wait(),c("success")}catch(e){console.error("Update certificate error:",e),p(e.reason||e.message||"Failed to update certificate"),c("error")}};return(0,i.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-[#0b0f1a] to-black text-white",children:(0,i.jsxs)("div",{className:"mx-auto max-w-4xl px-6 py-12",children:[(0,i.jsxs)("header",{className:"mb-8 flex items-center justify-between",children:[(0,i.jsx)(l(),{href:"/",className:"text-xl font-semibold tracking-tight",children:"CERTHUB"}),(0,i.jsx)("div",{className:"text-sm",children:e?(0,i.jsxs)("span",{className:"rounded-md bg-emerald-500/10 px-3 py-1 text-emerald-300",children:["✅ Connected: ",e.slice(0,6),"…",e.slice(-4)]}):(0,i.jsx)("span",{className:"rounded-md bg-yellow-500/10 px-3 py-1 text-yellow-300",children:"⚠️ Please connect your wallet"})})]}),(0,i.jsxs)("section",{className:"mb-10",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold sm:text-4xl",children:"Update Certificate"}),(0,i.jsx)("p",{className:"mt-2 text-white/70",children:"Update certificate details on the Hyperion Testnet. Only verified institutions and admins can access this page."})]}),(0,i.jsxs)("form",{onSubmit:w,className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Institution Name *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"institutionName",value:r.institutionName,onChange:b,placeholder:"e.g., Havard",required:!0})]}),(0,i.jsxs)("div",{className:"mb-6 rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Previous Certificate Details"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Previous Certificate Name *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"previousCertificateName",value:r.previousCertificateName,onChange:b,placeholder:"e.g., celo",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Previous Certificate Year *"}),(0,i.jsx)("input",{type:"number",className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"previousCertificateYear",value:r.previousCertificateYear,onChange:b,placeholder:"e.g., 2027",required:!0})]})]})]}),(0,i.jsxs)("div",{className:"mb-6 rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Update Details"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"New Certificate Name *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"certificateName",value:r.certificateName,onChange:b,placeholder:"e.g., New Celo",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Certificate ID *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"certificateId",value:r.certificateId,onChange:b,placeholder:"e.g., CEL23-UPD",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"URI *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"uri",value:r.uri,onChange:b,placeholder:"e.g., ipfs://Qm...",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"New Certificate Year *"}),(0,i.jsx)("input",{type:"number",className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"newCertificateYear",value:r.newCertificateYear,onChange:b,placeholder:"e.g., 2028",required:!0})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Recipients (for new Merkle root, comma-separated)"}),(0,i.jsx)("textarea",{className:"w-full min-h-[100px] rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"recipients",value:r.recipients,onChange:b,placeholder:"0xabc..., 0xdef..."}),(0,i.jsx)("button",{type:"button",onClick:N,disabled:x||!r.recipients.trim(),className:"mt-2 rounded-lg border border-white/20 bg-white/10 px-4 py-2 text-sm text-white hover:bg-white/15 disabled:opacity-50",children:x?"Generating…":"Generate Merkle Root & Download Proofs"}),m&&(0,i.jsxs)("p",{className:"mt-2 text-xs text-emerald-400",children:["Generated Merkle Root: ",m]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Certificate Token Update Quantity *"}),(0,i.jsx)("input",{type:"number",className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",name:"certificateTokenUpdateQuantity",value:r.certificateTokenUpdateQuantity,onChange:b,placeholder:"e.g., 100",required:!0})]})]})]}),u&&(0,i.jsx)("div",{className:"mt-4 rounded-lg border border-red-500/30 bg-red-500/10 p-3 text-sm text-red-300",children:u}),"success"===d&&(0,i.jsx)("div",{className:"mt-4 rounded-lg border border-emerald-500/30 bg-emerald-500/10 p-3 text-sm text-emerald-300",children:"Certificate updated successfully!"}),(0,i.jsxs)("div",{className:"mt-6 flex items-center gap-3",children:[(0,i.jsx)("button",{type:"submit",disabled:"loading"===d,className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-700 disabled:opacity-50",children:"loading"===d?"Updating…":"Update Certificate"}),(0,i.jsx)(l(),{href:"/",className:"text-white/70 hover:underline",children:"Back to Home"})]})]}),(0,i.jsxs)("div",{className:"mt-10 rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"What happens next?"}),(0,i.jsxs)("ul",{className:"list-disc space-y-1 pl-5 text-sm text-white/70",children:[(0,i.jsxs)("li",{children:["An on-chain ",(0,i.jsx)("em",{children:"CertificateUpdated"})," event is emitted."]}),(0,i.jsx)("li",{children:"The certificate's details are updated in the contract."}),(0,i.jsx)("li",{children:"Recipients can continue to claim using the updated Merkle root."})]})]})]})})}},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},7259:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/kreed/CERTHUBDEPLOYMENT_TEST/frontend3/CERTHUB-creation/app/update-certificate/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/kreed/CERTHUBDEPLOYMENT_TEST/frontend3/CERTHUB-creation/app/update-certificate/page.tsx","default")},7598:e=>{"use strict";e.exports=require("node:crypto")},7883:(e,t,r)=>{Promise.resolve().then(r.bind(r,7259))},7971:(e,t,r)=>{Promise.resolve().then(r.bind(r,5197))},8857:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var i=r(5239),a=r(8088),s=r(8170),n=r.n(s),o=r(893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d={children:["",{children:["update-certificate",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7259)),"/home/kreed/CERTHUBDEPLOYMENT_TEST/frontend3/CERTHUB-creation/app/update-certificate/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"/home/kreed/CERTHUBDEPLOYMENT_TEST/frontend3/CERTHUB-creation/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/home/kreed/CERTHUBDEPLOYMENT_TEST/frontend3/CERTHUB-creation/app/update-certificate/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/update-certificate/page",pathname:"/update-certificate",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[447,872,471,928,198],()=>r(8857));module.exports=i})();