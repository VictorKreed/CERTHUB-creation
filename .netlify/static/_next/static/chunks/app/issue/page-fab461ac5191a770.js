(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[254],{1973:(e,t,r)=>{"use strict";r.d(t,{k:()=>a});var i=r(9592),s=r(3041);class a extends s._y{#e;#t;constructor(e,t,r){let s=Object.assign({},null!=r?r:{},{batchMaxCount:1});(0,i.MR)(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(t,s),this.#t=null,r&&r.providerInfo&&(this.#t=r.providerInfo),this.#e=async(t,r)=>{let i={method:t,params:r};this.emit("debug",{action:"sendEip1193Request",payload:i});try{let t=await e.request(i);return this.emit("debug",{action:"receiveEip1193Result",result:t}),t}catch(t){let e=Error(t.message);throw e.code=t.code,e.data=t.data,e.payload=i,this.emit("debug",{action:"receiveEip1193Error",error:e}),e}}}get providerInfo(){return this.#t}async send(e,t){return await this._start(),await super.send(e,t)}async _send(e){(0,i.MR)(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{let t=await this.#e(e.method,e.params||[]);return[{id:e.id,result:t}]}catch(t){return[{id:e.id,error:{code:t.code,data:t.data,message:t.message}}]}}getRpcError(e,t){switch((t=JSON.parse(JSON.stringify(t))).error.code||-1){case 4001:t.error.message=`ethers-user-denied: ${t.error.message}`;break;case 4200:t.error.message=`ethers-unsupported: ${t.error.message}`}return super.getRpcError(e,t)}async hasSigner(e){null==e&&(e=0);let t=await this.send("eth_accounts",[]);return"number"==typeof e?t.length>e:(e=e.toLowerCase(),0!==t.filter(t=>t.toLowerCase()===e).length)}async getSigner(e){if(null==e&&(e=0),!await this.hasSigner(e))try{await this.#e("eth_requestAccounts",[])}catch(t){let e=t.payload;throw this.getRpcError(e,{id:e.id,error:t})}return await super.getSigner(e)}static async discover(e){if(null==e&&(e={}),e.provider)return new a(e.provider);let t=e.window?e.window:"undefined"!=typeof window?window:null;if(null==t)return null;let r=e.anyProvider;if(r&&t.ethereum)return new a(t.ethereum);if(!("addEventListener"in t&&"dispatchEvent"in t&&"removeEventListener"in t))return null;let s=e.timeout?e.timeout:300;return 0===s?null:await new Promise((l,n)=>{let d=[],o=e=>{d.push(e.detail),r&&c()},c=()=>{if(clearTimeout(u),d.length){if(e&&e.filter){let t=e.filter(d.map(e=>Object.assign({},e.info)));if(null==t)l(null);else if(t instanceof a)l(t);else{let e=null;if(t.uuid&&(e=d.filter(e=>t.uuid===e.info.uuid)[0]),e){let{provider:t,info:r}=e;l(new a(t,void 0,{providerInfo:r}))}else n((0,i.xz)("filter returned unknown info","UNSUPPORTED_OPERATION",{value:t}))}}else{let{provider:e,info:t}=d[0];l(new a(e,void 0,{providerInfo:t}))}}else l(null);t.removeEventListener("eip6963:announceProvider",o)},u=setTimeout(()=>{c()},s);t.addEventListener("eip6963:announceProvider",o),t.dispatchEvent(new Event("eip6963:requestProvider"))})}}},7141:(e,t,r)=>{Promise.resolve().then(r.bind(r,8846))},8846:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var i=r(5155),s=r(6874),a=r.n(s),l=r(2115),n=r(6172),d=r(5062),o=r(2037);let c={institutionName:"",certificateName:"",certificateId:"",uri:"",year:"",quantity:"",recipients:"",verifiedWalletAddress:""};function u(){let[e,t]=(0,l.useState)(c),[r,s]=(0,l.useState)(null),[u,h]=(0,l.useState)(!1),[m,p]=(0,l.useState)(!1),[f,x]=(0,l.useState)(null),[g,w]=(0,l.useState)(null),[v,b]=(0,l.useState)(null),[y,N]=(0,l.useState)(null),[j,C]=(0,l.useState)(null),[k,E]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{await (0,n.LK)();let r=await (0,n.Vy)();s(r),r&&!e.verifiedWalletAddress&&t(e=>({...e,verifiedWalletAddress:r}))}catch(e){}})()},[]);let q=(0,l.useMemo)(()=>!!r&&r.toLowerCase()===e.verifiedWalletAddress.toLowerCase(),[r,e.verifiedWalletAddress]),I=(0,l.useMemo)(()=>{let t;let r=Number(e.year),i=Number(e.quantity);return e.institutionName.trim().length>1&&e.certificateName.trim().length>1&&e.certificateId.trim().length>1&&e.uri.trim().length>3&&r>=1900&&r<=3e3&&i>=1&&(t=e.verifiedWalletAddress,/^0x[a-fA-F0-9]{40}$/.test(t))&&e.recipients.trim().length>0},[e]);function S(e,r){t(t=>({...t,[e]:r}))}async function A(){b(null),N(null),C(null),E(null);let t=e.recipients.split(/[\s,]+/).map(e=>e.trim()).filter(e=>e&&(0,d.PW)(e));if(0===t.length){b("Please provide at least one valid Ethereum address.");return}try{p(!0);let r=await fetch("/api/merkle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({addresses:t,sortPairs:!0})}),i=await r.json();if(!r.ok||!(null==i?void 0:i.root))throw Error("Failed to generate Merkle root.");N(i.root),C(i.count),E(i);let s=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="proofs-".concat(e.certificateId||"certificate",".json"),l.click(),URL.revokeObjectURL(a)}catch(e){b(e.message||"Failed to generate Merkle root.")}finally{p(!1)}}async function P(t){if(t.preventDefault(),b(null),x(null),w(null),!I){b("Please complete all required fields with valid values.");return}if(!q){b("The connected wallet must match the verified wallet address.");return}if(!y){b("Please generate a Merkle root first.");return}try{var r,i;h(!0);let t=await (0,n.C8)(),s=await t.createCertificate(e.institutionName,e.certificateName,e.certificateId,e.uri,y,Number(e.year),Number(e.quantity),(0,o.b)(e.verifiedWalletAddress)),a=await s.wait();x(null!==(i=null!==(r=null==a?void 0:a.hash)&&void 0!==r?r:null==s?void 0:s.hash)&&void 0!==i?i:null);let l=a.logs.filter(e=>e.address.toLowerCase()===t.address).map(e=>t.interface.parseLog(e)).find(e=>(null==e?void 0:e.name)==="CertificateDeployed");l&&w(l.args.certificateAddress)}catch(e){b((null==e?void 0:e.reason)||(null==e?void 0:e.shortMessage)||(null==e?void 0:e.message)||"Transaction failed. Please check your wallet and try again.")}finally{h(!1)}}return(0,i.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-[#0b0f1a] to-black text-white",children:(0,i.jsxs)("div",{className:"mx-auto max-w-4xl px-6 py-12",children:[(0,i.jsxs)("header",{className:"mb-8 flex items-center justify-between",children:[(0,i.jsx)(a(),{href:"/",className:"text-xl font-semibold tracking-tight",children:"CERTHUB"}),(0,i.jsx)("div",{className:"text-sm",children:r?(0,i.jsxs)("span",{className:"rounded-md bg-emerald-500/10 px-3 py-1 text-emerald-300",children:["✅ Connected: ",r.slice(0,6),"…",r.slice(-4)]}):(0,i.jsx)("span",{className:"rounded-md bg-yellow-500/10 px-3 py-1 text-yellow-300",children:"⚠️ Please connect your wallet"})})]}),(0,i.jsxs)("section",{className:"mb-10",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold sm:text-4xl",children:"Issue a New Certificate"}),(0,i.jsx)("p",{className:"mt-2 text-white/70",children:"Deploy a new certificate clone on the Hyperion Testnet. Provide details and recipient addresses to generate a Merkle root for claiming."})]}),(0,i.jsxs)("form",{onSubmit:P,className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Institution Name *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.institutionName,onChange:e=>S("institutionName",e.target.value),placeholder:"University of Blockchain",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Certificate Name *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.certificateName,onChange:e=>S("certificateName",e.target.value),placeholder:"Advanced Solidity",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Certificate ID *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.certificateId,onChange:e=>S("certificateId",e.target.value),placeholder:"CERT-2025-0001",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Year *"}),(0,i.jsx)("input",{type:"number",min:1900,max:3e3,className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.year,onChange:e=>S("year",e.target.value),placeholder:"2025",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Token Quantity *"}),(0,i.jsx)("input",{type:"number",min:1,className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.quantity,onChange:e=>S("quantity",e.target.value),placeholder:"100",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Verified Wallet Address *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.verifiedWalletAddress,onChange:e=>S("verifiedWalletAddress",e.target.value),placeholder:"0x...",required:!0}),r&&e.verifiedWalletAddress&&r.toLowerCase()===e.verifiedWalletAddress.toLowerCase()&&(0,i.jsx)("span",{className:"text-xs text-emerald-400",children:"Connected"})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Certificate URI *"}),(0,i.jsx)("input",{className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.uri,onChange:e=>S("uri",e.target.value),placeholder:"ipfs://... or https://example.com/metadata.json",required:!0})]}),(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{className:"text-sm text-white/70",children:"Recipients (comma, space, or newline-separated addresses) *"}),(0,i.jsx)("textarea",{className:"w-full min-h-[100px] rounded-lg border border-white/10 bg-white/5 px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-400",value:e.recipients,onChange:e=>S("recipients",e.target.value),placeholder:"0xabc..., 0xdef..., 0x123...",required:!0}),(0,i.jsx)("button",{type:"button",onClick:A,disabled:m||!e.recipients.trim(),className:"mt-3 rounded-lg border border-white/20 bg-white/10 px-4 py-2 text-sm text-white hover:bg-white/15 disabled:opacity-50",children:m?"Generating…":"Generate Merkle Root & Download Proofs"}),y&&(0,i.jsxs)("div",{className:"mt-2 text-xs text-emerald-400",children:["Merkle Root: ",y," (",j," recipients)"]})]})]}),v&&(0,i.jsx)("div",{className:"mt-4 rounded-lg border border-red-500/30 bg-red-500/10 p-3 text-sm text-red-300",children:v}),f&&(0,i.jsxs)("div",{className:"mt-4 rounded-lg border border-emerald-500/30 bg-emerald-500/10 p-3 text-sm text-emerald-300",children:["Certificate deployed successfully."," ",(0,i.jsx)("a",{className:"underline hover:text-emerald-200",href:"https://hyperion-testnet-explorer.metisdevops.link/tx/".concat(f),target:"_blank",rel:"noreferrer",children:"View Transaction"}),g&&(0,i.jsxs)(i.Fragment,{children:[" • ",(0,i.jsx)("a",{className:"underline hover:text-emerald-200",href:"https://hyperion-testnet-explorer.metisdevops.link/address/".concat(g),target:"_blank",rel:"noreferrer",children:"View Contract"})]}),(0,i.jsx)("p",{className:"mt-2 text-xs text-white/60",children:"Recipients can now claim their certificates using the downloaded proofs."})]}),(0,i.jsxs)("div",{className:"mt-6 flex items-center gap-3",children:[(0,i.jsx)("button",{type:"submit",disabled:u||!I||!q||!y,className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-700 disabled:opacity-50",children:u?"Submitting…":"Issue Certificate"}),(0,i.jsx)(a(),{href:"/",className:"text-white/70 hover:underline",children:"Back to Home"})]})]}),(0,i.jsxs)("div",{className:"mt-10 rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,i.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"What happens next?"}),(0,i.jsxs)("ul",{className:"list-disc space-y-1 pl-5 text-sm text-white/70",children:[(0,i.jsx)("li",{children:"A new certificate clone is deployed via the factory contract."}),(0,i.jsxs)("li",{children:["An on-chain ",(0,i.jsx)("em",{children:"CertificateDeployed"})," event is emitted."]}),(0,i.jsx)("li",{children:"Recipients can claim their certificates using the generated Merkle proofs."})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,41,172,441,684,358],()=>t(7141)),_N_E=e.O()}]);